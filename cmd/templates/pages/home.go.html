{{define "home"}}
{{template "top" .}}

{{if .Content}}
  {{$books := .Content}}

  <table class="books">
    <thead>
      <tr class="header">
        <th colspan="8">All books [<strong>{{len .Content}}</strong>]</th>
      </tr>
      <tr>
        <th class="isbn" width="1%">ISBN</th>
        <th class="status" width="1%">&nbsp;</th>
        <th class="title">Title</th>
        <th class="author">Author</th>
        <th class="series">Series</th>
        <th class="rating">Rating</th>
        <th class="genre">Genre</th>
        <th class="link" width="1%">&nbsp;</th>
      </tr>
    </thead>
    <tbody>
      {{range $books}}
      <tr>
        {{if .IsException}}
        <td class="isbn exception" width="1%">{{.ISBN}}</td>
        <td class="exception" colspan="6">{{.ExceptionReason}}</td>
        <td class="link exception" width="1%">
          <a title="Goodreads" href="{{.GetLinkGoodreads}}" target="_blank">GR</a>
          <br/>
          <a title="OpenLibrary" href="{{.GetLinkOpenLibrary}}" target="_blank">OL</a>
          <a title="LibraryThing" href="{{.GetLinkLibraryThing}}" target="_blank">LT</a>
          <a title="Waterstones" href="{{.GetLinkWaterstones}}" target="_blank">WS</a>
        </td>
        {{else}}
        <td class="isbn" width="1%"><a href="#">{{.ISBN}}</a></td>
        <td class="status"><span title="{{.Status}}" class="status-icon status-icon-{{.StatusIcon}}">{{.GetStatusLetter}}</span></td>
        <td class="title"><a href="#">{{.Title}}</a></td>
        <td class="author">{{.GetAuthorSortHtmlDisplay}}</td>
        <td class="series">{{.GetSeriesSort}}</td>
        <td class="rating" title="{{.Rating}} out of 5">
          {{if .Rating}}
          {{$rating := .Rating}}
          {{range $i := For 5}}
          <span class="star {{if lt $i $rating}}filled{{end}}">&starf;</span>
          {{end}}
          {{end}}
        </td>
        <td class="genre">{{.GetGenreHtmlDisplay}}</td>
        <td class="link" width="1%">
          <a title="Google Books" href="{{.GetLinkGoogleBooksView}}" target="_blank">GB</a>
          <a title="Google Books API" href="{{.GetLinkGoogleBooksJson}}" target="_blank">JS</a>
          <a title="Goodreads" href="{{.GetLinkGoodreads}}" target="_blank">GR</a>
          <br/>
          <a title="OpenLibrary" href="{{.GetLinkOpenLibrary}}" target="_blank">OL</a>
          <a title="LibraryThing" href="{{.GetLinkLibraryThing}}" target="_blank">LT</a>
          <a title="Waterstones" href="{{.GetLinkWaterstones}}" target="_blank">WS</a>
        </td>
        {{end}}
      </tr>
      {{end}}
    </tbody>
  </table>
{{else}}
  <h1>There are no books in your collection.</h1>
{{end}}

{{template "base" .}}
{{end}}